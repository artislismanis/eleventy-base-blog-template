/**
 * Code Highlighting Bundle Styles
 *
 * All values use CSS custom properties with bundle-scoped naming.
 * Users override by redefining these properties in their own CSS.
 *
 * Naming convention: --code-{property}
 * This avoids collision with other bundles while staying concise.
 */

// Default values (user can override via :root or scoped selectors)
:root {
	// Colors
	--code-bg: #1e1e1e;
	--code-fg: #d4d4d4;

	// Typography
	--code-font-family: 'Fira Code', 'Consolas', 'Monaco', 'Courier New', monospace;
	--code-font-size: 0.875rem;
	--code-line-height: 1.6;

	// Spacing & Shape
	--code-border-radius: 0.5rem;
	--code-padding: 1rem;
	--code-margin: 1.5rem 0;

	// Copy button
	--code-copy-button-bg: rgba(255, 255, 255, 0.1);
	--code-copy-button-fg: #fff;
	--code-copy-button-hover-bg: rgba(255, 255, 255, 0.2);
	--code-copy-button-active-bg: rgba(255, 255, 255, 0.3);
	--code-copy-button-padding: 0.375rem 0.75rem;
	--code-copy-button-font-size: 0.75rem;
	--code-copy-button-border-radius: 0.25rem;

	// Line numbers
	--code-line-number-fg: rgba(255, 255, 255, 0.3);
	--code-line-number-width: 3rem;
	--code-line-number-padding: 0 0.75rem 0 0;

	// Scrollbar
	--code-scrollbar-width: 8px;
	--code-scrollbar-height: 8px;
	--code-scrollbar-thumb-bg: rgba(255, 255, 255, 0.2);
	--code-scrollbar-thumb-hover-bg: rgba(255, 255, 255, 0.3);
}

// Base code block styles
pre[class*='language-'] {
	background: var(--code-bg);
	color: var(--code-fg);
	font-family: var(--code-font-family);
	font-size: var(--code-font-size);
	line-height: var(--code-line-height);
	border-radius: var(--code-border-radius);
	padding: var(--code-padding);
	margin: var(--code-margin);
	overflow-x: auto;
	position: relative;
	tab-size: 2;

	code {
		font-family: inherit;
		font-size: inherit;
		background: none;
		padding: 0;
		color: inherit;
	}

	// Custom scrollbar
	&::-webkit-scrollbar {
		height: var(--code-scrollbar-height);
	}

	&::-webkit-scrollbar-track {
		background: transparent;
	}

	&::-webkit-scrollbar-thumb {
		background: var(--code-scrollbar-thumb-bg);
		border-radius: calc(var(--code-scrollbar-height) / 2);

		&:hover {
			background: var(--code-scrollbar-thumb-hover-bg);
		}
	}
}

// Copy button
.code-copy-button {
	position: absolute;
	top: 0.5rem;
	right: 0.5rem;
	background: var(--code-copy-button-bg);
	color: var(--code-copy-button-fg);
	border: none;
	border-radius: var(--code-copy-button-border-radius);
	padding: var(--code-copy-button-padding);
	font-size: var(--code-copy-button-font-size);
	font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
	cursor: pointer;
	opacity: 0;
	transition: opacity 0.2s ease, background-color 0.2s ease;
	z-index: 1;

	// Show on hover
	pre:hover & {
		opacity: 1;
	}

	// Always show on focus (accessibility)
	&:focus-visible {
		opacity: 1;
		outline: 2px solid var(--code-copy-button-fg);
		outline-offset: 2px;
	}

	&:hover {
		background: var(--code-copy-button-hover-bg);
	}

	&:active {
		background: var(--code-copy-button-active-bg);
	}

	// Copied state
	&.copied {
		background: rgba(34, 197, 94, 0.8); // Green
	}

	// Error state
	&.error {
		background: rgba(239, 68, 68, 0.8); // Red
	}
}

// Line numbers (when enabled)
pre.line-numbers {
	padding-left: calc(var(--code-line-number-width) + var(--code-padding));
	position: relative;

	.line-numbers-rows {
		position: absolute;
		top: var(--code-padding);
		left: 0;
		width: var(--code-line-number-width);
		padding: var(--code-line-number-padding);
		text-align: right;
		user-select: none;
		pointer-events: none;
		color: var(--code-line-number-fg);
		font-family: var(--code-font-family);
		font-size: var(--code-font-size);
		line-height: var(--code-line-height);

		span {
			display: block;
			counter-increment: linenumber;

			&::before {
				content: counter(linenumber);
			}
		}
	}

	// Reset counter
	counter-reset: linenumber;
}

// Inline code (not affected by bundle)
:not(pre) > code[class*='language-'] {
	background: var(--code-bg);
	color: var(--code-fg);
	padding: 0.125rem 0.375rem;
	border-radius: 0.25rem;
	font-family: var(--code-font-family);
	font-size: 0.875em;
}
